"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[551],{5932:(e,t,r)=>{r.d(t,{r:()=>f});var o=r(5155),a=r(2115),n=r(9318),l=r(3312),i=r(3473),s=r(6527);function c(e){let{onZoomIn:t,onZoomOut:r}=e;return(0,o.jsxs)("div",{className:"absolute bottom-4 right-4 flex flex-col gap-2",children:[(0,o.jsx)(l.$,{variant:"outline",size:"icon",className:"w-8 h-8 bg-black/50 backdrop-blur-sm border-primary/30 hover:bg-primary/20",onClick:t,children:(0,o.jsx)(i.A,{className:"h-4 w-4"})}),(0,o.jsx)(l.$,{variant:"outline",size:"icon",className:"w-8 h-8 bg-black/50 backdrop-blur-sm border-primary/30 hover:bg-primary/20",onClick:r,children:(0,o.jsx)(s.A,{className:"h-4 w-4"})})]})}var d=r(9749);function u(e){let{planet:t,mode:r,onClose:a,onSelect:n,position:i}=e;return(0,o.jsx)("div",{className:"absolute z-50 pointer-events-auto",style:{left:"".concat(i.x,"px"),top:"".concat(i.y,"px"),transform:"translate(-50%, -100%)"},children:(0,o.jsxs)(d.Zp,{className:"w-80 bg-black/90 backdrop-blur-sm border-primary/30",children:[(0,o.jsx)(d.aR,{className:"pb-2",children:(0,o.jsxs)(d.ZB,{className:"text-lg text-primary flex justify-between items-center",children:[t.name,(0,o.jsxs)("span",{className:"text-xs font-mono text-primary/60",children:["[",t.coordinate_x,", ",t.coordinate_y,"]"]})]})}),(0,o.jsxs)(d.Wu,{className:"space-y-3",children:[(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("span",{className:"text-muted-foreground",children:"Size: "}),(0,o.jsxs)("span",{className:"font-mono",children:[t.size_km.toLocaleString()," km"]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("span",{className:"text-muted-foreground",children:"Biome: "}),(0,o.jsx)("span",{className:"font-mono capitalize",children:t.biome})]})]}),t.owner_id&&(0,o.jsxs)("div",{className:"text-sm",children:[(0,o.jsx)("span",{className:"text-muted-foreground",children:"Status: "}),(0,o.jsx)("span",{className:"font-mono text-red-400",children:"Colonized"})]}),(0,o.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,o.jsx)(l.$,{variant:"outline",size:"sm",onClick:a,className:"flex-1 border-primary/30 hover:bg-primary/20",children:"Close"}),(()=>{switch(r){case"homeworld":return(0,o.jsx)(l.$,{size:"sm",onClick:n,className:"flex-1 bg-primary hover:bg-primary/80",children:"Select Homeworld"});case"mission-target":return(0,o.jsx)(l.$,{size:"sm",onClick:n,className:"flex-1 bg-primary hover:bg-primary/80",children:"Select Target"});default:return null}})()]})]})]})})}let m=(e,t)=>({ocean:"rgba(56, 189, 248, ".concat(t,")"),jungle:"rgba(234, 179, 8, ".concat(t,")"),desert:"rgba(249, 115, 22, ".concat(t,")"),ice:"rgba(34, 211, 238, ".concat(t,")"),volcanic:"rgba(239, 68, 68, ".concat(t,")")})[e]||"rgba(32, 224, 160, ".concat(t,")"),h=e=>3+(e-1e3)/49e3*5;function f(e){let{mode:t,onPlanetSelect:r,allowedPlanets:l=[],highlightedPlanets:i=[],initialZoom:s=1,initialCenter:d,width:f="800px",height:x="600px",focusedPlanet:g}=e,{state:p}=(0,n.I)(),[v,b]=(0,a.useState)({x:(null==d?void 0:d.x)||0,y:(null==d?void 0:d.y)||0,zoom:s}),[y,w]=(0,a.useState)(null),[j,k]=(0,a.useState)(!1),[N,z]=(0,a.useState)(!1),C=(0,a.useRef)({x:0,y:0,viewportX:0,viewportY:0}),M=(0,a.useRef)(null),_=(0,a.useRef)(null),S=(0,a.useRef)(0),R=(0,a.useCallback)(e=>{if(e.preventDefault(),e.ctrlKey){let t=M.current;if(!t)return;let r=t.getBoundingClientRect(),o=e.clientX-r.left,a=e.clientY-r.top,n=(o-t.width/2+v.x)/v.zoom,l=(a-t.height/2+v.y)/v.zoom,i=e.deltaY<0?1.1:1/1.1,s=Math.min(Math.max(v.zoom*i,.8*Math.max(t.width/1e4,t.height/1e4)),5),c=o-n*s,d=a-l*s;b(e=>({...e,zoom:s,x:c,y:d}))}else b(t=>({...t,x:t.x-e.deltaX/t.zoom,y:t.y-e.deltaY/t.zoom}))},[v.zoom]),E=(0,a.useCallback)(e=>{0===e.button&&(z(!0),C.current={x:e.clientX,y:e.clientY,viewportX:v.x,viewportY:v.y})},[v]),T=(0,a.useCallback)(e=>{if(!N)return;let t=e.clientX-C.current.x,r=e.clientY-C.current.y;b(e=>({...e,x:C.current.viewportX-t/e.zoom,y:C.current.viewportY-r/e.zoom}))},[N]),P=(0,a.useCallback)(()=>{z(!1)},[]),X=(0,a.useCallback)((e,t)=>{let r=M.current;return r?{x:(e+5e3)*v.zoom+r.width/2-v.x,y:(t+5e3)*v.zoom+r.height/2-v.y}:{x:0,y:0}},[v]),Y=(0,a.useCallback)(()=>{var e;let t=M.current,r=null==t?void 0:t.getContext("2d");if(!t||!r)return;t.width=t.clientWidth,t.height=t.clientHeight,r.fillStyle="#000814",r.fillRect(0,0,t.width,t.height);let o=50*v.zoom,a=Math.floor((v.x-t.width/2)/o)*o,n=Math.floor((v.y-t.height/2)/o)*o,s=Math.ceil((v.x+t.width/2)/o)*o,c=Math.ceil((v.y+t.height/2)/o)*o;r.strokeStyle="rgba(32, 224, 160, 0.15)",r.lineWidth=1;for(let e=a;e<=s;e+=o){let o=e-v.x+t.width/2;r.beginPath(),r.moveTo(o,0),r.lineTo(o,t.height),r.stroke()}for(let e=n;e<=c;e+=o){let o=e-v.y+t.height/2;r.beginPath(),r.moveTo(0,o),r.lineTo(t.width,o),r.stroke()}let d=X(0,0);r.strokeStyle="rgba(255, 0, 0, 0.3)",r.lineWidth=2,r.beginPath(),r.moveTo(0,d.y),r.lineTo(t.width,d.y),r.stroke(),r.strokeStyle="rgba(0, 0, 255, 0.3)",r.beginPath(),r.moveTo(d.x,0),r.lineTo(d.x,t.height),r.stroke(),null===(e=p.planets)||void 0===e||e.forEach(e=>{let t=X(e.coordinate_x,e.coordinate_y),o=h(e.size_km)*v.zoom,a=r.createRadialGradient(t.x,t.y,o,t.x,t.y,3*o),n=m(e.biome,1);a.addColorStop(0,n.replace("1)","0.3)")),a.addColorStop(1,n.replace("1)","0)")),r.fillStyle=a,r.beginPath(),r.arc(t.x,t.y,3*o,0,2*Math.PI),r.fill();let s=i.includes(e.id),c=!l||l.includes(e.id);r.fillStyle=m(e.biome,c?1:.4),r.beginPath(),r.arc(t.x,t.y,o,0,2*Math.PI),r.fill(),s&&(r.strokeStyle="rgba(32, 224, 160, 0.8)",r.lineWidth=2,r.stroke()),r.font="".concat(12*v.zoom,"px monospace"),r.fillStyle=s?"#20e0a0":"#ffffff",r.textAlign="center",r.fillText(e.name,t.x,t.y-2.5*o)}),S.current=requestAnimationFrame(Y)},[p.planets,v,i,l,X]);(0,a.useEffect)(()=>(Y(),()=>{S.current&&cancelAnimationFrame(S.current)}),[Y]),(0,a.useEffect)(()=>(window.addEventListener("mousemove",T),window.addEventListener("mouseup",P),window.addEventListener("wheel",R,{passive:!1}),()=>{window.removeEventListener("mousemove",T),window.removeEventListener("mouseup",P),window.removeEventListener("wheel",R)}),[T,P,R]);let B=(0,a.useCallback)(e=>{var t;if(N)return;let r=M.current,o=null==r?void 0:r.getBoundingClientRect();if(!o||!r)return;let a=e.clientX-o.left,n=e.clientY-o.top,i=null===(t=p.planets)||void 0===t?void 0:t.find(e=>{let t=X(e.coordinate_x,e.coordinate_y),r=a-t.x,o=n-t.y;return Math.sqrt(r*r+o*o)<20*v.zoom});i&&(!l||l.includes(i.id))&&(w(i),k(!0))},[p.planets,v,l,N,X]),L=(0,a.useMemo)(()=>y?X(y.coordinate_x,y.coordinate_y):{x:0,y:0},[y,X]),A=(0,a.useCallback)(e=>{let t=M.current;t&&b(r=>{let o=r.zoom*(e?.1:10),a=.8*Math.max(t.width/1e4,t.height/1e4);return{...r,zoom:Math.min(Math.max(o,a),5)}})},[]);return(0,a.useEffect)(()=>{if(!g||!M.current)return;let e=M.current,t=.8*Math.max(e.width/1e4,e.height/1e4),r=Math.min(Math.max(1.5,v.zoom,t),5),o=(g.coordinate_x+5e3)*r-e.width/2,a=(g.coordinate_y+5e3)*r-e.height/2,n=v.x,l=v.y,i=v.zoom,s=Date.now(),c=()=>{let e=Math.min((Date.now()-s)/800,1),t=1-Math.pow(1-e,3);b(()=>({x:n+(o-n)*t,y:l+(a-l)*t,zoom:i+(r-i)*t})),e<1&&requestAnimationFrame(c)};c()},[g]),(0,o.jsxs)("div",{ref:_,className:"relative overflow-hidden border border-primary/20 rounded-lg",style:{cursor:N?"grabbing":"grab",width:f,height:x},children:[(0,o.jsx)("canvas",{ref:M,onClick:B,onMouseDown:E,className:"w-full h-full"}),j&&y&&(0,o.jsx)(u,{planet:y,mode:t,onClose:()=>k(!1),onSelect:()=>{null==r||r(y),k(!1)},viewport:v,position:L}),(0,o.jsx)(c,{onZoomIn:()=>A(!0),onZoomOut:()=>A(!1)})]})}},3312:(e,t,r)=>{r.d(t,{$:()=>c});var o=r(5155),a=r(2115),n=r(2317),l=r(1027),i=r(1567);let s=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:r,variant:a,size:l,asChild:c=!1,...d}=e,u=c?n.DX:"button";return(0,o.jsx)(u,{className:(0,i.cn)(s({variant:a,size:l,className:r})),ref:t,...d})});c.displayName="Button"},9749:(e,t,r)=>{r.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>s,Zp:()=>l,aR:()=>i,wL:()=>u});var o=r(5155),a=r(2115),n=r(1567);let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,o.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});l.displayName="Card";let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,o.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...a})});i.displayName="CardHeader";let s=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,o.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});s.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,o.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...a})});c.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,o.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...a})});d.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,o.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...a})});u.displayName="CardFooter"},1567:(e,t,r)=>{r.d(t,{_:()=>l,cn:()=>n,m:()=>i});var o=r(3463),a=r(9795);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,o.$)(t))}function l(e,t,r){let o=0;for(let[n,l]of Object.entries(e.available_researchs)){var a;let e=(null===(a=t.technologies[n])||void 0===a?void 0:a.level)||0;if(0!==e)for(let t of l.effects)t.type===r&&(t.per_level?o+=t.value*e/100:o+=t.value/100)}return 1+o}let i=e=>{let t=Math.floor(e/86400),r=Math.floor(e%86400/3600),o=Math.floor(e%3600/60),a=Math.floor(e%60);return[t>0&&"".concat(t,"d"),r>0&&"".concat(r,"h"),o>0&&"".concat(o,"m"),a>0&&"".concat(a,"s")].filter(Boolean).join(" ")}}}]);
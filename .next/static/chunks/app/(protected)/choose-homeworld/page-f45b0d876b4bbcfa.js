(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[352],{1771:(e,t,r)=>{Promise.resolve().then(r.bind(r,1972))},6527:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(7401).A)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},3473:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(7401).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},6165:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(7401).A)("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]])},1972:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>N});var a=r(5155),s=r(2115),o=r(9749),n=r(3312),l=r(3473),i=r(6527),c=r(1712),d=r(5534);let m=(e,t)=>({ocean:"rgba(56, 189, 248, ".concat(t,")"),jungle:"rgba(234, 179, 8, ".concat(t,")"),desert:"rgba(249, 115, 22, ".concat(t,")"),ice:"rgba(34, 211, 238, ".concat(t,")"),volcanic:"rgba(239, 68, 68, ".concat(t,")")})[e]||"rgba(32, 224, 160, ".concat(t,")"),u=(e,t,r)=>Math.min(Math.max(e,t),r),h=e=>3+(e-1e3)/49e3*5;function p(){let[e,t]=(0,s.useState)([]),[r,p]=(0,s.useState)(null),[y,x]=(0,s.useState)(!0),g=(0,s.useRef)(null),v=(0,s.useRef)(null),[b,f]=(0,s.useState)({x:0,y:0,zoom:1}),[j,N]=(0,s.useState)(null),w=async e=>{try{await d.F.planets.claim(e,!0)}catch(e){console.error("Error choosing homeworld:",e)}},[C,S]=(0,s.useState)(null),k=e=>{if(e.length<2)return null;let t=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(t*t+r*r)},M=e=>{e.preventDefault(),e.ctrlKey||f(t=>{let r=1e4*t.zoom-g.current.width;return{...t,x:u(t.x-e.deltaX,0,r),y:u(t.y-e.deltaY,0,r)}})},E=e=>{let t=k(e.touches);t&&S(t)},A=e=>{if(e.preventDefault(),1===e.touches.length){let t=e.touches[0],r=e.touches[0];f(e=>{let a=1e4*e.zoom-g.current.width;return{...e,x:u(e.x-(t.clientX-r.clientX),0,a),y:u(e.y-(t.clientY-r.clientY),0,a)}})}},_=()=>{S(null)};(0,s.useEffect)(()=>{let e=g.current;if(e)return e.addEventListener("wheel",M,{passive:!1}),e.addEventListener("touchstart",E),e.addEventListener("touchmove",A,{passive:!1}),e.addEventListener("touchend",_),()=>{e.removeEventListener("wheel",M),e.removeEventListener("touchstart",E),e.removeEventListener("touchmove",A),e.removeEventListener("touchend",_)}},[b,C]),(0,s.useEffect)(()=>{(async()=>{let{data:e,error:r}=await c.N.from("planets").select("*").is("owner_id",null);if(r){console.error("Error fetching planets:",r);return}t(e||[]),x(!1)})()},[]),(0,s.useEffect)(()=>{if(!g.current||y)return;let t=g.current,a=t.getContext("2d");if(!a)return;let s=()=>{v.current&&(t.width=v.current.clientWidth,t.height=v.current.clientHeight)};return s(),window.addEventListener("resize",s),(()=>{a.fillStyle="#000814",a.fillRect(0,0,t.width,t.height),a.strokeStyle="rgba(32, 224, 160, 0.15)",a.lineWidth=1;let s=50*b.zoom,o=Math.floor(b.x/s),n=Math.floor(b.y/s),l=Math.ceil((b.x+t.width)/s),i=Math.ceil((b.y+t.height)/s);for(let e=o;e<=l;e++)for(let t=n;t<=i;t++){let r=e*s-b.x,o=t*s-b.y;a.strokeRect(r,o,s,s)}e.forEach(e=>{let o=(e.coordinate_x+5e3)*b.zoom-b.x,n=(e.coordinate_y+5e3)*b.zoom-b.y;if(o>=-s&&o<=t.width+s&&n>=-s&&n<=t.height+s){let t=(null==r?void 0:r.id)===e.id,s=h(e.size_km)*(t?8:6)*b.zoom;a.strokeStyle=m(e.biome,.4),a.lineWidth=2*b.zoom,a.beginPath(),a.arc(o,n,1.2*s,0,2*Math.PI),a.stroke();let l=a.createRadialGradient(o,n,0,o,n,s);l.addColorStop(0,m(e.biome,.8)),l.addColorStop(.6,m(e.biome,.3)),l.addColorStop(1,"transparent"),a.fillStyle=l,a.beginPath(),a.arc(o,n,s,0,2*Math.PI),a.fill(),a.fillStyle=m(e.biome,1),a.beginPath(),a.arc(o,n,6*b.zoom,0,2*Math.PI),a.fill();let i=Math.min(Math.max(14*b.zoom,10),36);a.fillStyle="#fff",a.font="bold ".concat(i,'px "Space Mono", monospace'),a.textAlign="center",a.textBaseline="middle",a.shadowColor=m(e.biome,1),a.shadowBlur=10,a.fillText(e.name,o,n+1.5*s)}})})(),()=>window.removeEventListener("resize",s)},[e,r,b,y]);let z=e=>{let t=Math.min(Math.max(b.zoom*(e?1.2:.8333333333333334),.1),10),r=g.current;if(!r)return;let a=r.width/2,s=r.height/2;f(e=>({x:e.x+(a-r.width/2)*(1-t/e.zoom),y:e.y+(s-r.height/2)*(1-t/e.zoom),zoom:t}))};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold neon-text mb-2",children:"SELECT YOUR HOMEWORLD"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Choose your starting planet carefully, Commander. This decision will shape your destiny."}),j&&(0,a.jsxs)("p",{className:"text-sm text-muted-foreground mt-2",children:["Selected Grid Coordinates: [",j.x,","," ",j.y,"]"]})]}),y?(0,a.jsx)("div",{className:"text-center neon-text",children:"SCANNING AVAILABLE PLANETS..."}):(0,a.jsxs)("div",{ref:v,className:"relative h-[600px] rounded-lg neon-border overflow-hidden",children:[(0,a.jsx)("canvas",{ref:g,onClick:t=>{var r;let a=null===(r=g.current)||void 0===r?void 0:r.getBoundingClientRect();if(!a)return;let s=t.clientX-a.left,o=t.clientY-a.top;N({x:Math.floor((s+b.x)/b.zoom-5e3),y:Math.floor((o+b.y)/b.zoom-5e3)});let n=e.find(e=>30>Math.sqrt(Math.pow(s-((e.coordinate_x+5e3)*b.zoom-b.x),2)+Math.pow(o-((e.coordinate_y+5e3)*b.zoom-b.y),2)));n&&p(n)},className:"cursor-crosshair"}),(0,a.jsxs)("div",{className:"absolute top-4 right-4 flex flex-col gap-2",children:[(0,a.jsxs)(n.$,{variant:"outline",size:"icon",onClick:()=>z(!0),className:"w-8 h-8 bg-black/30 border-primary/30 hover:bg-primary/20 hover:border-primary/60 neon-border",children:[(0,a.jsx)(l.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Zoom In"})]}),(0,a.jsxs)(n.$,{variant:"outline",size:"icon",onClick:()=>z(!1),className:"w-8 h-8 bg-black/30 border-primary/30 hover:bg-primary/20 hover:border-primary/60 neon-border",children:[(0,a.jsx)(i.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Zoom Out"})]})]}),r&&(0,a.jsx)("div",{className:"absolute bottom-4 left-4 right-4",children:(0,a.jsxs)(o.Zp,{className:"bg-card/80 backdrop-blur-sm",children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{className:"neon-text text-lg",children:r.name})}),(0,a.jsxs)(o.Wu,{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Coordinates: "}),(0,a.jsxs)("span",{className:"font-mono",children:["[",r.coordinate_x.toLocaleString(),",",r.coordinate_y.toLocaleString(),"]"]})]}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Size: "}),(0,a.jsxs)("span",{className:"font-mono",children:[r.size_km.toLocaleString()," km"]})]}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Biome: "}),(0,a.jsx)("span",{className:"font-mono",style:{color:m(r.biome,1)},children:r.biome.replace("_"," ")})]})]})]})})]}),(0,a.jsx)("div",{className:"flex justify-center mt-6",children:(0,a.jsx)(n.$,{disabled:!r,onClick:()=>r&&w(r.id),className:"px-8 py-6 text-xl bg-primary hover:bg-primary/80 text-primary-foreground neon-border",children:"ESTABLISH COLONY"})})]})}var y=r(9318),x=r(6046),g=r(5932),v=r(6165),b=r(2373),f=r(3873);let j={0:{preview:{sender:"Supreme Council",subject:"Commander Assignment Protocol",preview:"URGENT: Supreme Council",time:"Just now",highlight:!0},content:{title:"Commander Assignment Protocol",subject:"Commander Assignment Protocol",from:"Supreme Leader of the Galactic Council",body:["Greetings, Commander.",'On behalf of the Galactic Council, I extend my congratulations on your graduation from the Elite Commander Academy. Your exceptional "performance" has not gone unnoticed.',"As per protocol, you are now required to select your first command post. Choose your homeworld wisely, as it will serve as the foundation for your future operations and contributions to our galactic civilization.","The Council awaits your decision."]}},1:{preview:{sender:"Mom",subject:"Important Reminders for My Space Commander!",preview:"Don't forget to eat your space vegetables! \uD83E\uDD6C",time:"1 hour ago"},content:{title:"Important Reminders for My Space Commander!",subject:"Important Reminders for My Space Commander!",from:"Mom",body:["Sweetie! \uD83D\uDC96","I know you're about to command your very own planet, but don't forget:",{type:"list",items:["Pack your warm space socks - space is cold!","Remember to brush your teeth after each meal (even freeze-dried ones)","Call me at least twice per galactic cycle","Don't talk to strange aliens unless they've been properly introduced","Keep your ray gun charged and your quarters tidy"]},"I put some homemade cosmic cookies in your cargo bay. Share them with your crew! \uD83C\uDF6A","PS: Your father says to remember the trick about reversing the polarity - whatever that means! \uD83E\uDD37‍♀️",{type:"signature",text:"Lots of love and virtual hugs! \uD83E\uDD17\nMom"}]}},2:{preview:{sender:"Cadet ZX-427 (Your Roommate)",subject:"Try Not to Crash Anything Important!",preview:"LOL good luck out there! \uD83D\uDE80",time:"2 hours ago"},content:{title:"Try Not to Crash Anything Important!",subject:"Try Not to Crash Anything Important!",from:"Cadet ZX-427",body:['Hey "Commander" \uD83D\uDE02',"Can't believe they're actually letting you command a planet! Remember when you crashed the simulator so bad they had to reset the entire system? Good times!","Just don't pick the same sector as me - I've seen your piloting skills and I like my ships intact! \uD83D\uDE80\uD83D\uDCA5","P.S. You still owe me 50 credits from that bet about passing the tactical exam! \uD83D\uDCB8",{type:"signature",text:"- Your favorite roommate"}]}},3:{preview:{sender:"Class Valedictorian",subject:"Congratulations on Your... Unique Approach",preview:"Thanks for making me look good \uD83D\uDE0F",time:"5 hours ago"},content:{title:"Congratulations on Your... Unique Approach",subject:"Congratulations on Your... Unique Approach",from:"Class Valedictorian",body:['Dear "Graduate",',"I just wanted to thank you for your... memorable performance during the final exams. Your creative interpretation of battle formations made me look absolutely brilliant in comparison! ✨",'But seriously, who would\'ve thought that "accidentally" activating the self-destruct sequence would become a legitimate tactical maneuver? They literally had to rewrite the rulebook because of you. \uD83E\uDD2F',"May your future enemies be as confused by your strategies as we all were. \uD83C\uDF1F",{type:"signature",text:"Best regards,\nThe one who actually read the manual \uD83D\uDCDA"}]}}};function N(){let{state:e}=(0,y.I)(),{unclaimedPlanets:t,loading:r}=(0,b.H)(),l=(0,x.useRouter)(),[i,c]=(0,s.useState)("message"),[m,u]=(0,s.useState)(null),h=async e=>{try{await d.F.planets.claim(e.id,!0),l.push("/dashboard")}catch(e){console.error("Error claiming planet:",e)}};if((0,s.useEffect)(()=>{var t;(null===(t=e.selectedPlanet)||void 0===t?void 0:t.id)&&l.push("/dashboard")},[e.selectedPlanet,l]),r)return(0,a.jsx)(f.x,{message:"SCANNING STAR SYSTEMS..."});if("message"===i){var N;return(0,a.jsx)("div",{className:"min-h-screen bg-background p-6 bg-[url('/assets/space-bg.jpg')] bg-cover",children:(0,a.jsx)("div",{className:"container mx-auto backdrop-blur-sm",children:(0,a.jsxs)(o.Zp,{className:"border-2 h-[calc(100vh-3rem)] shadow-2xl shadow-primary/20 animate-fade-in",children:[(0,a.jsx)(o.aR,{className:"border-b bg-gray-900",children:(0,a.jsxs)(o.ZB,{className:"text-xl flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 text-xs border border-gray-600",children:"_"}),(0,a.jsx)("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 text-xs border border-gray-600",children:"□"}),(0,a.jsx)("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 text-xs border border-gray-600",children:"\xd7"})]}),(0,a.jsx)("span",{className:"text-primary font-mono ml-4",children:"Galactic Mail Terminal v3.14"})]})}),(0,a.jsx)(o.Wu,{className:"p-0 h-[calc(100%-4rem)] bg-gray-900/95",children:(0,a.jsxs)("div",{className:"grid grid-cols-[250px_1fr] h-full",children:[(0,a.jsx)("div",{className:"border-r border-primary/20 p-4 space-y-3 bg-gray-900",children:Object.entries(j).map(e=>{let[t,r]=e;return(0,a.jsxs)("div",{className:"p-3 border border-primary/30 rounded-md cursor-pointer transition-all duration-300 hover:scale-105 hover:bg-gray-800 hover:border-primary ".concat(m===Number(t)?"bg-gray-800 border-primary scale-105":""),onClick:()=>u(Number(t)),children:[(0,a.jsxs)("p",{className:"font-medium ".concat(r.preview.highlight?"text-yellow-500 flex items-center gap-2":"text-blue-400"),children:[r.preview.highlight&&(0,a.jsx)("span",{className:"animate-ping",children:"★"}),r.preview.preview]}),(0,a.jsx)("p",{className:"text-sm text-gray-400 truncate",children:r.preview.preview}),(0,a.jsx)("p",{className:"text-xs text-primary/60",children:r.preview.time})]},t)})}),(0,a.jsx)("div",{className:"p-6 overflow-y-auto bg-gray-900/90",children:null!==m?(0,a.jsxs)("div",{className:"space-y-4 animate-fade-in",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[0===m&&(0,a.jsx)("p",{className:"font-bold text-2xl text-yellow-500 animate-pulse",children:j[m].content.title}),(0,a.jsxs)("p",{className:"text-sm text-gray-300",children:["Subject: ",j[m].content.subject]}),(0,a.jsxs)("p",{className:"text-sm text-gray-300",children:["From: ",j[m].content.from]}),(0,a.jsxs)("p",{className:"text-sm text-gray-300",children:["To: Commander"," ",(null===(N=e.currentUser)||void 0===N?void 0:N.name)||"[REDACTED]"]}),(0,a.jsx)("div",{className:"border-t border-primary/30 my-4"})]}),(0,a.jsxs)("div",{className:"text-gray-200 space-y-4",children:[j[m].content.body.map((e,t)=>"string"==typeof e?(0,a.jsx)("p",{children:e},t):"list"===e.type?(0,a.jsx)("ul",{className:"list-disc pl-5 space-y-2",children:e.items.map((e,t)=>(0,a.jsx)("li",{children:e},t))},t):"signature"===e.type?(0,a.jsx)("p",{className:"text-blue-300 whitespace-pre-line",children:e.text},t):void 0),0===m&&(0,a.jsx)(n.$,{className:"mt-8 w-full py-6 text-xl font-bold bg-primary/40 border-2 border-primary hover:bg-primary/60 hover:border-primary/80 transition-all duration-300 group shadow-lg shadow-primary/30",onClick:()=>c("choose"),children:(0,a.jsx)("span",{className:"group-hover:scale-105 transition-transform duration-300",children:"Accept Assignment"})})]})]}):(0,a.jsx)("div",{className:"h-full flex items-center justify-center text-gray-500 animate-pulse",children:"[SELECT MESSAGE TO DECRYPT]"})})]})})]})})})}return"messageOpen"===i?(0,a.jsx)("div",{className:"min-h-screen bg-background p-6",children:(0,a.jsx)("div",{className:"container mx-auto",children:(0,a.jsxs)(o.Zp,{className:"max-w-[600px] mx-auto",children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{children:"Proceeding to homeworld selection..."})}),(0,a.jsx)(o.Wu,{children:(0,a.jsx)(n.$,{className:"w-full",onClick:()=>c("choose"),children:"Continue"})})]})})}):"choose"===i?(0,a.jsx)("div",{className:"min-h-screen bg-background p-6",children:(0,a.jsx)("div",{className:"container mx-auto",children:(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsxs)(o.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(v.A,{className:"h-6 w-6 text-primary"}),"Choose Your Homeworld"]}),(0,a.jsxs)(o.BT,{children:[t.length," unclaimed planets available"]})]}),(0,a.jsxs)(o.Wu,{className:"p-6",children:[(0,a.jsx)("p",{className:"text-muted-foreground mb-6",children:"Select your starting planet from the available unclaimed worlds. Choose wisely - this will be your base of operations."}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(g.r,{mode:"homeworld",onPlanetSelect:h,allowedPlanets:t.map(e=>e.id),initialZoom:.5,initialCenter:{x:0,y:0}})})]})]})})}):(0,a.jsx)("div",{className:"min-h-screen bg-background p-6",children:(0,a.jsx)("div",{className:"container mx-auto",children:(0,a.jsx)(p,{})})})}},2373:(e,t,r)=>{"use strict";r.d(t,{H:()=>o});var a=r(2115),s=r(9318);function o(){var e;let{state:t}=(0,s.I)(),r=(0,a.useMemo)(()=>{var e;return(null===(e=t.planets)||void 0===e?void 0:e.filter(e=>!e.owner_id))||[]},[t.planets]),o=(0,a.useMemo)(()=>{var e;return(null===(e=t.planets)||void 0===e?void 0:e.filter(e=>{var r;return e.owner_id===(null===(r=t.currentUser)||void 0===r?void 0:r.id)}))||[]},[t.planets,null===(e=t.currentUser)||void 0===e?void 0:e.id]);return{planets:t.planets,loading:!t.loadedPlanets,unclaimedPlanets:r,userPlanets:o,getNeighboringPlanets:(e,r)=>t.planets?t.planets.filter(t=>{let a=t.coordinate_x-e.coordinate_x,s=t.coordinate_y-e.coordinate_y;return Math.sqrt(a*a+s*s)<=r&&t.id!==e.id}):[],getPlanetsByBiome:e=>{var r;return(null===(r=t.planets)||void 0===r?void 0:r.filter(t=>t.biome===e))||[]}}}},5534:(e,t,r)=>{"use strict";r.d(t,{F:()=>o});var a=r(1712);async function s(e,t,r){let s=await a.N.auth.getSession().then(e=>{let{data:{session:t}}=e;return null==t?void 0:t.access_token}),o=await fetch("".concat("http://localhost:3001/").concat(e,"/").concat(t),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify(r)});if(!o.ok)throw Error("HTTP error! status: ".concat(o.status));return o.json()}let o={admin:{updateConfig:async(e,t)=>s("admin","updateConfig",{id:e,config_data:t})},researchs:{startResearch:async(e,t)=>s("researchs","startResearch",{technology_id:e,planet_id:t})},chat:{sendMessage:async(e,t)=>s("chat","sendMessage",{channel_id:e,text:t})},users:{register:async(e,t)=>s("users","register",{id:e,name:t}),update:async(e,t)=>s("users","update",{name:e,avatar:t})},planets:{claim:async(e,t)=>s("planets","claim",{planet_id:e,homeworld:t})},structures:{construct:async(e,t)=>s("structures","construct",{planet_id:e,type:t}),upgrade:async(e,t)=>s("structures","upgrade",{planet_id:e,structure_id:t})},fleet:{buildShip:async(e,t,r)=>s("fleet","buildShip",{ship_type:e,planet_id:t,amount:r}),renameShip:async(e,t)=>s("fleet","renameShip",{ship_id:e,new_name:t})}}},1027:(e,t,r)=>{"use strict";r.d(t,{F:()=>n});var a=r(3463);let s=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,o=a.$,n=(e,t)=>r=>{var a;if((null==t?void 0:t.variants)==null)return o(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:n,defaultVariants:l}=t,i=Object.keys(n).map(e=>{let t=null==r?void 0:r[e],a=null==l?void 0:l[e];if(null===t)return null;let o=s(t)||s(a);return n[e][o]}),c=r&&Object.entries(r).reduce((e,t)=>{let[r,a]=t;return void 0===a||(e[r]=a),e},{});return o(e,i,null==t?void 0:null===(a=t.compoundVariants)||void 0===a?void 0:a.reduce((e,t)=>{let{class:r,className:a,...s}=t;return Object.entries(s).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...l,...c}[t]):({...l,...c})[t]===r})?[...e,r,a]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)}}},e=>{var t=t=>e(e.s=t);e.O(0,[149,345,318,551,441,517,358],()=>t(1771)),_N_E=e.O()}]);
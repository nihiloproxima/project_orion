(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[311],{1328:(e,s,t)=>{Promise.resolve().then(t.bind(t,3545))},3545:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>y});var a=t(5155),r=t(9749),l=t(7995),n=t(6165),c=t(7401);let d=(0,c.A)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),i=(0,c.A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),o=(0,c.A)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);var m=t(9318),u=t(6046),x=t(8173),h=t.n(x),p=t(2115),f=t(1712),N=t(5534),b=t(5565),j=t(7404);function y(){let e=(0,u.useRouter)(),{state:s}=(0,m.I)(),[t,c]=(0,p.useState)([]),[x,y]=(0,p.useState)(""),g=(0,p.useRef)(null);(0,p.useEffect)(()=>{(async()=>{let{data:e}=await f.N.from("chat_messages").select("*").order("created_at",{ascending:!1}).limit(50);e&&c(e.reverse())})();let e=f.N.channel("chat_messages").on("postgres_changes",{event:"INSERT",schema:"public",table:"chat_messages"},e=>{c(s=>[...s,e.new])}).subscribe();return()=>{e.unsubscribe()}},[]),(0,p.useEffect)(()=>{if(g.current){let e=g.current.querySelector("[data-radix-scroll-area-viewport]");e&&(e.scrollTop=e.scrollHeight)}},[t]);let v=async e=>{if(e.preventDefault(),x.trim())try{await N.F.chat.sendMessage("global",x),y("")}catch(e){console.error("Failed to send message:",e)}};return((0,p.useEffect)(()=>{s.loading||s.selectedPlanet||0!==s.userPlanets.length||e.push("/choose-homeworld")},[s.loading,s.selectedPlanet,s.userPlanets.length,e]),0===s.userPlanets.length)?(e.push("/choose-homeworld"),null):(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsx)("div",{className:"flex justify-between items-center",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold neon-text mb-2",children:"COMMAND CENTER"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Welcome, Commander. All systems operational."})]})}),(0,a.jsxs)(r.Zp,{className:"bg-red-900/30 border-red-500/50 backdrop-blur-sm animate-pulse",children:[(0,a.jsx)(r.aR,{className:"flex flex-row items-center justify-between pb-2",children:(0,a.jsx)(r.ZB,{className:"text-red-500 font-bold flex items-center gap-2",children:"⚠️ ALERT: INCOMING HOSTILE FLEET"})}),(0,a.jsx)(r.Wu,{children:(0,a.jsxs)("div",{className:"text-red-400 space-y-2",children:[(0,a.jsx)("p",{children:"Hostile fleet detected approaching Colony Alpha-7"}),(0,a.jsxs)("div",{className:"font-mono text-xl",children:["Time until impact: ",(0,a.jsx)("span",{className:"text-red-500",children:"14:32"})]}),(0,a.jsx)("div",{className:"text-sm",children:"Fleet composition: 5 Battlecruisers, 12 Destroyers"})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)(r.Zp,{className:"bg-card/50 backdrop-blur-sm neon-border hover:shadow-[0_0_20px_rgba(32,224,160,0.3)] transition-all duration-300",children:[(0,a.jsxs)(r.aR,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(r.ZB,{className:"text-sm font-medium neon-text",children:"FLEET STATUS"}),(0,a.jsx)(n.A,{className:"h-4 w-4 text-primary"})]}),(0,a.jsxs)(r.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:"15 Ships"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"3 in combat, 12 in orbit"})]})]}),(0,a.jsxs)(r.Zp,{className:"bg-card/50 backdrop-blur-sm neon-border hover:shadow-[0_0_20px_rgba(32,224,160,0.3)] transition-all duration-300",children:[(0,a.jsxs)(r.aR,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(r.ZB,{className:"text-sm font-medium neon-text",children:"SYSTEM STATUS"}),(0,a.jsx)(d,{className:"h-4 w-4 text-primary"})]}),(0,a.jsxs)(r.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:"OPTIMAL"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"All systems green"})]})]}),(0,a.jsxs)(r.Zp,{className:"bg-card/50 backdrop-blur-sm neon-border hover:shadow-[0_0_20px_rgba(32,224,160,0.3)] transition-all duration-300",children:[(0,a.jsxs)(r.aR,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(r.ZB,{className:"text-sm font-medium neon-text",children:"ACTIVE COMMANDERS"}),(0,a.jsx)(i,{className:"h-4 w-4 text-primary"})]}),(0,a.jsxs)(r.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:s.activePlayers}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Currently online"})]})]})]}),(0,a.jsxs)(r.Zp,{className:"bg-card/50 backdrop-blur-sm neon-border h-[400px] flex flex-col",children:[(0,a.jsx)(r.aR,{className:"pb-2",children:(0,a.jsxs)(r.ZB,{className:"neon-text flex items-center gap-2",children:[(0,a.jsx)(o,{className:"h-4 w-4"}),"UNIVERSAL COMMS"]})}),(0,a.jsxs)(r.Wu,{className:"flex-1 flex flex-col overflow-hidden",children:[(0,a.jsx)(l.F,{className:"flex-1",ref:g,children:(0,a.jsx)("div",{className:"space-y-4 font-mono pr-4",children:t.map(e=>{var s;return(0,a.jsxs)("div",{className:"text-sm break-words flex items-start gap-2",children:[e.sender_avatar?(0,a.jsx)(b.default,{src:(0,j.w)("avatars",e.sender_avatar+".webp"),width:100,height:100,alt:e.sender_name||"User",className:"w-6 h-6 flex-shrink-0 object-cover"}):(0,a.jsx)("div",{className:"w-6 h-6 rounded-full bg-primary/10 flex-shrink-0 flex items-center justify-center text-[10px] uppercase",children:(null===(s=e.sender_name)||void 0===s?void 0:s[0])||"?"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"text-primary whitespace-nowrap",children:["[",new Date(e.created_at).toLocaleTimeString(),"]"]})," ",(0,a.jsxs)(h(),{href:"user_message"===e.type?"/user/".concat(e.sender_id):"#",className:"text-secondary ".concat("system_message"===e.type?"text-red-500":""," ").concat("user_message"===e.type?"hover:underline":""),onClick:s=>{"user_message"!==e.type&&s.preventDefault()},children:[e.sender_name,":"]})," ",(0,a.jsx)("span",{className:"text-muted-foreground ".concat("system_message"===e.type?"text-red-400":""),children:e.text})]})]},e.id)})})}),(0,a.jsx)("form",{onSubmit:v,className:"border border-primary/30 rounded p-2 mt-4",children:(0,a.jsx)("input",{type:"text",value:x,onChange:e=>y(e.target.value),placeholder:"> Enter message...",className:"w-full bg-transparent border-none focus:outline-none text-primary placeholder:text-primary/50"})})]})]})]})}},9749:(e,s,t)=>{"use strict";t.d(s,{BT:()=>i,Wu:()=>o,ZB:()=>d,Zp:()=>n,aR:()=>c,wL:()=>m});var a=t(5155),r=t(2115),l=t(1567);let n=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r})});n.displayName="Card";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",t),...r})});c.displayName="CardHeader";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",t),...r})});d.displayName="CardTitle";let i=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("text-sm text-muted-foreground",t),...r})});i.displayName="CardDescription";let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("p-6 pt-0",t),...r})});o.displayName="CardContent";let m=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",t),...r})});m.displayName="CardFooter"},7995:(e,s,t)=>{"use strict";t.d(s,{F:()=>c});var a=t(5155),r=t(2115),l=t(1868),n=t(1567);let c=r.forwardRef((e,s)=>{let{className:t,children:r,...c}=e;return(0,a.jsxs)(l.bL,{ref:s,className:(0,n.cn)("relative overflow-hidden",t),...c,children:[(0,a.jsx)(l.LM,{className:"h-full w-full rounded-[inherit]",children:r}),(0,a.jsx)(d,{}),(0,a.jsx)(l.OK,{})]})});c.displayName=l.bL.displayName;let d=r.forwardRef((e,s)=>{let{className:t,orientation:r="vertical",...c}=e;return(0,a.jsx)(l.VM,{ref:s,orientation:r,className:(0,n.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...c,children:(0,a.jsx)(l.lr,{className:"relative flex-1 rounded-full bg-border"})})});d.displayName=l.VM.displayName},5534:(e,s,t)=>{"use strict";t.d(s,{F:()=>l});var a=t(1712);async function r(e,s,t){let r=await a.N.auth.getSession().then(e=>{let{data:{session:s}}=e;return null==s?void 0:s.access_token}),l=await fetch("".concat("http://localhost:3001/").concat(e,"/").concat(s),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify(t)});if(!l.ok)throw Error("HTTP error! status: ".concat(l.status));return l.json()}let l={admin:{updateConfig:async(e,s)=>r("admin","updateConfig",{id:e,config_data:s})},researchs:{startResearch:async(e,s)=>r("researchs","startResearch",{technology_id:e,planet_id:s})},chat:{sendMessage:async(e,s)=>r("chat","sendMessage",{channel_id:e,text:s})},users:{register:async(e,s)=>r("users","register",{id:e,name:s}),update:async(e,s)=>r("users","update",{name:e,avatar:s})},planets:{claim:async(e,s)=>r("planets","claim",{planet_id:e,homeworld:s})},structures:{construct:async(e,s)=>r("structures","construct",{planet_id:e,type:s}),upgrade:async(e,s)=>r("structures","upgrade",{planet_id:e,structure_id:s})},fleet:{buildShip:async(e,s,t)=>r("fleet","buildShip",{ship_type:e,planet_id:s,amount:t}),renameShip:async(e,s)=>r("fleet","renameShip",{ship_id:e,new_name:s})}}},7404:(e,s,t)=>{"use strict";t.d(s,{w:()=>r});var a=t(1712);let r=(e,s)=>{let{data:t}=a.N.storage.from(e).getPublicUrl(s);return t.publicUrl}},1567:(e,s,t)=>{"use strict";t.d(s,{_:()=>n,cn:()=>l,m:()=>c});var a=t(3463),r=t(9795);function l(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.QP)((0,a.$)(s))}function n(e,s,t){let a=0;for(let[l,n]of Object.entries(e.available_researchs)){var r;let e=(null===(r=s.technologies[l])||void 0===r?void 0:r.level)||0;if(0!==e)for(let s of n.effects)s.type===t&&(s.per_level?a+=s.value*e/100:a+=s.value/100)}return 1+a}let c=e=>{let s=Math.floor(e/86400),t=Math.floor(e%86400/3600),a=Math.floor(e%3600/60),r=Math.floor(e%60);return[s>0&&"".concat(s,"d"),t>0&&"".concat(t,"h"),a>0&&"".concat(a,"m"),r>0&&"".concat(r,"s")].filter(Boolean).join(" ")}}},e=>{var s=s=>e(e.s=s);e.O(0,[149,345,440,173,280,318,441,517,358],()=>s(1328)),_N_E=e.O()}]);